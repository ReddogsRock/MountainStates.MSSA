"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_apps-management_apps-list_apps-list_component_ts-projects_eav-ui_src_-5efbee"],{3140:(y,v,e)=>{e.d(v,{J:()=>E});var h=e(27092),f=e(99293);let E=(()=>{class u{constructor(){this.subscriptions=new h.yU}ngOnDestroy(){this.subscriptions.unsubscribe()}static#e=this.\u0275fac=function(A){return new(A||u)};static#t=this.\u0275dir=f.FsC({type:u})}return u})()},18537:(y,v,e)=>{e.d(v,{R:()=>p});var h=e(82645),f=e(43942),E=e(1365),u=e(88830),l=e(81530),C=e(38067);const A=["addListener","removeListener"],P=["addEventListener","removeEventListener"],T=["on","off"];function p(s,o,c,_){if((0,l.T)(c)&&(_=c,c=void 0),_)return p(s,o,c).pipe((0,C.I)(_));const[M,U]=function a(s){return(0,l.T)(s.addEventListener)&&(0,l.T)(s.removeEventListener)}(s)?P.map(O=>b=>s[O](o,b,c)):function d(s){return(0,l.T)(s.addListener)&&(0,l.T)(s.removeListener)}(s)?A.map(m(s,o)):function D(s){return(0,l.T)(s.on)&&(0,l.T)(s.off)}(s)?T.map(m(s,o)):[];if(!M&&(0,u.X)(s))return(0,E.Z)(O=>p(O,o,c))((0,h.Tg)(s));if(!M)throw new TypeError("Invalid event target");return new f.c(O=>{const b=(...F)=>O.next(1<F.length?F:F[0]);return M(b),()=>U(b)})}function m(s,o){return c=>_=>s[c](o,_)}},28136:(y,v,e)=>{e.d(v,{T:()=>h});const h={AppSyncWithSiteFiles:"AppSyncWithSiteFiles",WysiwygPasteFormatted:"WysiwygPasteFormatted",PasteImageFromClipboard:"PasteImageFromClipboard",EditUiShowNotes:"EditUiShowNotes",EditUiShowMetadataFor:"EditUiShowMetadataFor",NoSponsoredByToSic:"NoSponsoredByToSic",EditUiTranslateWithGoogle:"EditUiTranslateWithGoogle",LightSpeed:"LightSpeedOutputCache",ContentSecurityPolicy:"ContentSecurityPolicy",PermissionsByLanguage:"PermissionsByLanguage",ContentTypeFieldsReuseDefinitions:"ContentTypeFieldsReuseDefinitions",AppExportAssetsAdvanced:"AppExportAssetsAdvanced",DataExportImportBundles:"DataExportImportBundles",PickerUiCheckbox:"PickerUiCheckbox",PickerUiRadio:"PickerUiRadio",PickerSourceCsv:"PickerSourceCsv",PickerSourceAppAssets:"PickerSourceAppAssets",PickerFormulas:"PickerFormulas",PickerUiMoreInfo:"PickerUiMoreInfo"}},34575:(y,v,e)=>{e.d(v,{S:()=>A});var h=e(37580),f=e(44444),E=e(18537),u=e(3140),l=e(99293),C=e(3347);let A=(()=>{class P extends u.J{constructor(p,m,d){super(),this.zone=m,this.snackBar=d,this.markStyle=(0,h.hFB)("outline"),this.allowedFileTypes=(0,h.hFB)(""),this.filesDropped=(0,h.CGW)(),this.dropAreaClass="eav-droparea",this.markStyleClass=(0,f.vPA)(""),this.dragClass="eav-dragover",this.timeouts=[],this.element=p.nativeElement}ngOnInit(){this.markStyleClass.set(`eav-droparea-${this.markStyle()}`),this.element.classList.add(this.dropAreaClass,this.markStyleClass()),this.zone.runOutsideAngular(()=>{this.subscriptions.add((0,E.R)(this.element,"dragover").subscribe(p=>{p.preventDefault(),p.stopPropagation(),this.clearTimeouts(),this.element.classList.add(this.dragClass)})),this.subscriptions.add((0,E.R)(this.element,"dragleave").subscribe(p=>{p.preventDefault(),p.stopPropagation(),this.timeouts.push(window.setTimeout(()=>{this.element.classList.remove(this.dragClass)},50))}))})}ngOnDestroy(){this.clearTimeouts(),this.element.classList.remove(this.dropAreaClass,this.markStyleClass(),this.dragClass),super.ngOnDestroy()}onDrop(p){p.preventDefault(),p.stopPropagation(),this.clearTimeouts(),this.element.classList.remove(this.dragClass);let d=Array.from(p.dataTransfer.files);d=this.filterTypes(d,this.allowedFileTypes()),d.length>0&&this.filesDropped.emit(d)}clearTimeouts(){for(const p of this.timeouts)clearTimeout(p);this.timeouts=[]}filterTypes(p,m){if(""===m)return p;const d=m.split(",").map(a=>a.toLocaleLowerCase()),D=p.filter(a=>{const s=a.name.lastIndexOf(".");if(s<=0)return!1;const o=a.name.substring(s+1).toLocaleLowerCase();return d.includes(o)});if(p.length!==D.length){const a=this.allowedFileTypes().replace(/\,/g,", ");this.snackBar.open(D.length?"Some files were filtered out. This drop location only accepts file types: "+a:"This drop location only accepts file types: "+a,null,{duration:5e3})}return D}static#e=this.\u0275fac=function(m){return new(m||P)(l.rXU(l.aKT),l.rXU(l.SKi),l.rXU(C.UG))};static#t=this.\u0275dir=l.FsC({type:P,selectors:[["","appDragAndDrop",""]],hostBindings:function(m,d){1&m&&l.bIt("drop",function(a){return d.onDrop(a)})},inputs:{markStyle:[1,"markStyle"],allowedFileTypes:[1,"allowedFileTypes"]},outputs:{filesDropped:"filesDropped"},features:[l.Vt3]})}return P})()},60852:(y,v,e)=>{e.d(v,{c:()=>m});var h=e(29658),f=e(51567),E=e(63037),u=e(70271),l=e(5057),C=e(98764),A=e(34435),P=e(4979),T=e(44444);const p={doOnDialogClosed:!0};let m=(()=>{class d extends P.V{constructor(a,s){super(),this.router=a,this.route=s,this.log=(0,A.Tq)({DialogRoutingService:d},p)}get snapshot(){return this.route.snapshot}get url(){return this.router.url}get urlSegments(){return this.router.url.split("/")}getParam(a){return this.route.snapshot.paramMap.get(a)}getParams(a){const s=this.route.snapshot.paramMap;return a.reduce((o,c)=>(o[c]=s.get(c),o),{})}getQueryParam(a){return this.route.snapshot.queryParamMap.get(a)}getQueryParams(a){const s=this.route.snapshot.queryParamMap;return a.reduce((o,c)=>(o[c]=s.get(c),o),{})}state(){return this.router.getCurrentNavigation().extras?.state}doOnDialogClosed(a){const s=this.log.fnIf("doOnDialogClosed");this.subscriptions.add(this.childDialogClosed$().subscribe(o=>(s.a("Dialog closed",{data:o}),a()))),s.end()}doOnDialogClosedWithData(a){const s=this.log.fnIf("doOnDialogClosed");this.subscriptions.add(this.#e().subscribe(({state:o})=>{s.a("Dialog closed",{state:o}),a(o)})),s.end()}urlSubRoute(a){const s=this.router.createUrlTree([a],{relativeTo:this.route});return this.router.serializeUrl(s)}navPath(a,s){return this.router.navigate([a],s)}navRelative(a,s){return this.router.navigate(a,{...s,relativeTo:this.route})}childDialogClosed$(){return this.router.events.pipe((0,f.p)(a=>a instanceof h.wF),(0,E.Z)(!!this.route.snapshot.firstChild),(0,u.T)(()=>!!this.route.snapshot.firstChild),(0,l.J)(),(0,f.p)(([a,s])=>a&&!s))}#e(){return this.router.events.pipe((0,f.p)(a=>a instanceof h.wF),(0,C.M)(a=>{const s=this.log.fn("childDialogClosed$",{event:a,firstChild:this.route.snapshot.firstChild,snapShot:this.route.snapshot,state:this.router.getCurrentNavigation()?.extras.state});s.a("NavigationEnd",{event:a}),s.end()}),(0,E.Z)(!!this.route.snapshot.firstChild),(0,u.T)(()=>({hasChildNow:!!this.route.snapshot.firstChild,state:this.router.getCurrentNavigation()?.extras.state})),(0,l.J)(),(0,f.p)(([a,s])=>a.hasChildNow&&!s.hasChildNow),(0,u.T)(([a,s])=>({hadChildBefore:a.hasChildNow,hasChildNow:s.hasChildNow,state:s.state})))}static#t=this.\u0275fac=function(s){return new(s||d)(T.KVO(h.Ix),T.KVO(h.nX))};static#s=this.\u0275prov=T.jDH({token:d,factory:d.\u0275fac})}return d})()},69914:(y,v,e)=>{e.d(v,{$:()=>E});var h=e(99293),f=e(80436);let E=(()=>{class u{constructor(C){this.sanitizer=C}transform(C){return this.sanitizer.bypassSecurityTrustHtml(C)}static#e=this.\u0275fac=function(A){return new(A||u)(h.rXU(f.up,16))};static#t=this.\u0275pipe=h.EJ8({name:"safeHtml",type:u,pure:!0})}return u})()},81609:(y,v,e)=>{e.r(v),e.d(v,{AppsListComponent:()=>tt});var h=e(89204),f=e(1937),E=e(60184),u=e(87945),l=e(44444),C=e(16256),A=e(84175),P=e(81863),T=e(93840),p=e(29658),m=e(23183),d=e(12938),D=e(58713),a=e(28136),s=e(9001),o=e(9006),c=e(48991),_=e(11828),M=e(91960),U=e(60251),O=e(34575),b=e(59339),F=e(91922),S=e(34435),W=e(67037),j=e(60852),K=e(68873),k=e(83583);const x={states:{true:{tooltip:"Show this app to users",icon:"visibility"},false:{tooltip:"Hide this app from users",icon:"visibility_off"}}},$={states:{true:{clickable:!0,tooltip:"This App uses obsolete code which will cause problems on future upgrades. Click to see details.",icon:"bug_report",getUrl:g=>window.$2sxc.http.apiUrl("sys/insights/logs?key=warnings-obsolete&filter=AppId="+g.Id)},false:{tooltip:"Hide this app from users",icon:""}}};var G=e(89061),L=e(31034),N=e(5816),z=e(34601),t=e(99293),w=e(29968);function H(g,B){1&g&&(t.j41(0,"mat-icon"),t.EFF(1,"foundation"),t.k0s())}function X(g,B){1&g&&(t.j41(0,"mat-icon"),t.EFF(1,"holiday_village"),t.k0s())}function V(g,B){if(1&g){const n=t.RV6();t.j41(0,"button",7),t.bIt("click",function(){l.eBV(n);const i=t.XpG();return l.Njj(i.do("flushCache"))}),t.j41(1,"mat-icon"),t.EFF(2,"cached"),t.k0s(),t.j41(3,"span"),t.EFF(4,"Flush cache"),t.k0s()(),t.j41(5,"button",8),t.bIt("click",function(){l.eBV(n);const i=t.XpG();return l.Njj(i.do("deleteApp"))}),t.j41(6,"mat-icon"),t.EFF(7,"delete"),t.k0s(),t.j41(8,"span"),t.EFF(9,"Delete"),t.k0s()()}if(2&g){const n=t.XpG();t.R7$(5),t.Y8G("disabled",!n.app.IsApp)}}let Y=(()=>{class g{agInit(n){this.params=n,this.app=n.data}refresh(n){return!0}do(n){this.params.do(n,this.app)}static#e=this.\u0275fac=function(r){return new(r||g)};static#t=this.\u0275cmp=t.VBU({type:g,selectors:[["app-apps-list-actions"]],decls:11,vars:8,consts:[["menu","matMenu"],[1,"actions-component"],[1,"eav-grid-action-button","icon",3,"tippy","tippyDisabled"],[3,"lightSpeedOwner","params","lightSpeed"],["matRipple","","tippy","More",1,"eav-grid-action-button","highlight",3,"matMenuTriggerFor"],[1,"grid-more-menu"],["matMenuContent",""],["mat-menu-item","",3,"click"],["mat-menu-item","",3,"click","disabled"]],template:function(r,i){if(1&r&&(t.j41(0,"div",1)(1,"div",2),t.nVh(2,H,2,0,"mat-icon"),t.nVh(3,X,2,0,"mat-icon"),t.k0s(),t.nrm(4,"app-lightspeed-action",3),t.j41(5,"div",4)(6,"mat-icon"),t.EFF(7,"more_horiz"),t.k0s()()(),t.j41(8,"mat-menu",5,0),t.DNE(10,V,10,1,"ng-template",6),t.k0s()),2&r){const I=t.sdS(9);t.R7$(),t.Y8G("tippy",i.app.IsGlobal?"This app is global":i.app.IsInherited?"This app is inherited":"")("tippyDisabled",!i.app.IsGlobal&&!i.app.IsInherited),t.R7$(),t.vxM(i.app.IsGlobal?2:-1),t.R7$(),t.vxM(i.app.IsInherited?3:-1),t.R7$(),t.Y8G("lightSpeedOwner",i.app)("params",i.params)("lightSpeed",i.app.lightSpeed),t.R7$(),t.Y8G("matMenuTriggerFor",I)}},dependencies:[z.e,T.m_,T.An,C.Y,G.M,w.M,L.Cn,L.kk,L.fb,L.z8,L.Cp,N.V],encapsulation:2})}return g})();var J=e(37580),Q=e(3347),Z=e(58857);const q=g=>({"fab-opened":g});let tt=(()=>{class g{#e;#t;constructor(n,r,i,I,R){this.snackBar=n,this.context=r,this.matDialog=i,this.viewContainerRef=I,this.changeDetectorRef=R,this.log=(0,S.Tq)({AppsListComponent:g}),this.gridOptions=this.#r(),this.features=(0,l.WQX)(s.D),this.isAddFromFolderEnabled=this.features.isEnabled[a.T.AppSyncWithSiteFiles],this.#e=(0,d.d)(k.U),this.#t=(0,d.d)(j.c),this.fabOpen=(0,l.vPA)(!1),this.#s=(0,l.vPA)(0),this.apps=this.#e.getAllLive(this.#s).value,E.syG.registerModules([f.Q])}#s;ngOnInit(){this.#t.doOnDialogClosed(()=>this.#a())}openChange(n){this.fabOpen.set(n)}browseCatalog(){window.open("https://2sxc.org/apps","_blank")}createApp(){this.#t.navRelative(["create"])}createInheritedApp(){this.#t.navRelative(["create-inherited"])}addFromFolder(){this.#t.navRelative(["add-app-from-folder"])}importApp(n){this.#t.navRelative(["import"],{state:{files:n}})}#i(n){const r=prompt(`This cannot be undone. To really delete this app, type 'yes!' or type/paste the app-name here. Are you sure want to delete '${n.Name}' (${n.Id})?`);null!==r&&(r===n.Name||"yes!"===r?(this.snackBar.open("Deleting..."),this.#e.delete(n.Id).subscribe({error:()=>{this.snackBar.open("Delete failed. Please check console for more information",void 0,{duration:3e3}),this.#a()},next:()=>{this.snackBar.open("Deleted",void 0,{duration:2e3}),this.#a()}})):alert("Input did not match - will not delete"))}#n(n){var r=this;return(0,h.A)(function*(){if(confirm(`Flush the App Cache for ${n.Name} (${n.Id})?`)){r.snackBar.open("Flushing cache...");try{const i=yield r.#e.flushCache(n.Id);i>=200&&i<300&&r.snackBar.open("Cache flushed",void 0,{duration:2e3})}catch(i){r.snackBar.open("Cache flush failed. Please check console.",void 0,{duration:3e3}),console.error("Export error:",i)}}})()}#o(n){const r=(0,F.s)(D.g.getLightSpeedEditParams(n.Id));return this.#t.urlSubRoute(`${this.context.zoneId}/${n.Id}/edit/${r}`)}openLightSpeedFeatInfo(){(0,o.j)(this.matDialog,a.T.LightSpeed,this.viewContainerRef,this.changeDetectorRef)}#r(){return{...U.C,columnDefs:[{..._.r.IdWithDefaultRenderer,cellRendererParams:_.r.idFieldParamsTooltipGetter()},{..._.r.IconShow,cellRendererParams:{settings:()=>x}},{..._.r.TextWide,field:"Name",cellClass:"apps-list-primary-action highlight".split(" "),sort:"asc",cellRenderer:r=>{const i=r.data;return`\n              <a class="default-link fill-cell" href="#${this.#t.urlSubRoute(i.Id.toString())}">\n                <div class="container">\n                  ${i.Thumbnail?`<img class="image logo" src="${i.Thumbnail}?w=40&h=40&mode=crop"></img>`:'<div class="image logo"><span class="material-symbols-outlined">star</span></div>'}\n                  ${r.value}\n                </div>\n              </a>\n            `}},{..._.r.TextWide,field:"Folder"},{..._.r.Character,field:"Version",width:78},{..._.r.Number,field:"Items"},{..._.r.Boolean,field:"HasCodeWarnings",headerName:"Code",filter:M.y,cellRenderer:c.N,cellRendererParams:{settings:()=>$}},{..._.r.ActionsPinnedRight3,cellRenderer:Y,cellRendererParams:{lightSpeedLink:r=>this.#o(r),openLightspeedFeatureInfo:()=>this.openLightSpeedFeatInfo(),do:(r,i)=>{switch(r){case"deleteApp":this.#i(i);break;case"flushCache":this.#n(i)}}}}]}}#a(){this.#s.update(n=>++n)}static#l=this.\u0275fac=function(r){return new(r||g)(t.rXU(Q.UG),t.rXU(K.o),t.rXU(P.h),t.rXU(t.c1b),t.rXU(J.gRc))};static#p=this.\u0275cmp=t.VBU({type:g,selectors:[["app-apps-list"]],decls:25,vars:9,consts:[[1,"grid-wrapper","mat-tab-grid-wrapper"],["appDragAndDrop","",1,"ag-theme-material",3,"filesDropped","rowData","gridOptions","allowedFileTypes"],["align","end"],[1,"eav-eco-fab-speed-dial",3,"openChange","ngClass"],[3,"spin"],["mat-fab","",1,"grid-fab"],[1,"spin180"],[1,"eav-eco-fab-speed-dial-actions"],["mat-mini-fab","","label","Find more apps",1,"eav-eco-fab-speed-dial-action-button",3,"click"],["mat-mini-fab","","label","Create inherited app",1,"eav-eco-fab-speed-dial-action-button",3,"click"],["mat-mini-fab","","label","Add from folder",1,"eav-eco-fab-speed-dial-action-button",3,"click"],["matBadgeColor","accent","matBadgeSize","small","matBadgeIcon","diamond","matBadgePosition","below after","aria-hidden","false",3,"matBadgeHidden"],["mat-mini-fab","","label","Import app",1,"eav-eco-fab-speed-dial-action-button",3,"click"],["mat-mini-fab","","label","Create app",1,"eav-eco-fab-speed-dial-action-button",3,"click"]],template:function(r,i){1&r&&(t.j41(0,"div",0)(1,"ag-grid-angular",1),t.bIt("filesDropped",function(R){return i.importApp(R)}),t.k0s(),t.j41(2,"mat-dialog-actions",2)(3,"eco-fab-speed-dial",3),t.bIt("openChange",function(R){return i.openChange(R)}),t.j41(4,"eco-fab-speed-dial-trigger",4)(5,"button",5)(6,"mat-icon",6),t.EFF(7),t.k0s()()(),t.j41(8,"eco-fab-speed-dial-actions",7)(9,"button",8),t.bIt("click",function(){return i.browseCatalog()}),t.j41(10,"mat-icon"),t.EFF(11,"search"),t.k0s()(),t.j41(12,"button",9),t.bIt("click",function(){return i.createInheritedApp()}),t.j41(13,"mat-icon"),t.EFF(14,"holiday_village"),t.k0s()(),t.j41(15,"button",10),t.bIt("click",function(){return i.addFromFolder()}),t.j41(16,"mat-icon",11),t.EFF(17," add "),t.k0s()(),t.j41(18,"button",12),t.bIt("click",function(){return i.importApp()}),t.j41(19,"mat-icon"),t.EFF(20,"cloud_upload"),t.k0s()(),t.j41(21,"button",13),t.bIt("click",function(){return i.createApp()}),t.j41(22,"mat-icon"),t.EFF(23,"add"),t.k0s()()()()()(),t.nrm(24,"router-outlet")),2&r&&(t.R7$(),t.Y8G("rowData",i.apps())("gridOptions",i.gridOptions)("allowedFileTypes","zip"),t.R7$(2),t.Y8G("ngClass",t.eq3(7,q,i.fabOpen())),t.R7$(),t.Y8G("spin",!0),t.R7$(3),t.JRh(i.fabOpen()?"close":"add"),t.R7$(9),t.Y8G("matBadgeHidden",i.isAddFromFolderEnabled()))},dependencies:[W.p,Z.xs,P.M,m.TE,u.YU,m.p1,A.Hl,A.$0,A.Sr,T.m_,T.An,m.yf,C.Y,b.A,p.n3,O.S],styles:["[_nghost-%COMP%]     .ag-row-hover .ag-cell a, [_nghost-%COMP%]     .ag-row-hover .ag-cell .id-box *, [_nghost-%COMP%]     .ag-row-hover .ag-cell .eav-grid-action-button{color:#85283b!important}"]})}return g})()},83583:(y,v,e)=>{e.d(v,{U:()=>d});var h=e(89204),f=e(46443),E=e(24467),u=e(99293),l=e(44444);const T="admin/app/app";let d=(()=>{class D extends E.B{getAllLive(s){return(0,f.fx)(()=>(s(),{url:this.apiUrl("admin/app/list"),params:{zoneId:this.zoneId}}))}getInheritable(){return(0,f.fx)(()=>({url:this.apiUrl("admin/app/InheritableApps"),params:{zoneId:this.zoneId}}))}getPendingApps(){return(0,f.fx)(()=>({url:this.apiUrl("admin/app/GetPendingApps"),params:{zoneId:this.zoneId}}))}create(s,o,c){return this.http.post(this.apiUrl(T),{},{params:{zoneId:this.zoneId,name:s,...null!=o&&{inheritAppId:o},...null!=c&&{templateId:c}}})}createTemplate(s,o){const c=encodeURIComponent(o);return this.http.post(`sys/install/RemotePackage?packageUrl=${s}&newName=${c}`,{})}installPendingApps(s){return this.http.post(this.apiUrl("admin/app/InstallPendingApps"),s,{params:{zoneId:this.zoneId}})}delete(s){return this.http.delete(this.apiUrl(T),{params:{zoneId:this.zoneId,appId:s.toString()}})}flushCache(s){var o=this;return(0,h.A)(function*(){return o.getStatusPromise("admin/app/flushcache",{params:{zoneId:o.zoneId,appId:s.toString()}})})()}static#e=this.\u0275fac=(()=>{let s;return function(c){return(s||(s=u.xGo(D)))(c||D)}})();static#t=this.\u0275prov=l.jDH({token:D,factory:D.\u0275fac})}return D})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/20.00.09/dist/ng-edit/projects_eav-ui_src_app_apps-management_apps-list_apps-list_component_ts-projects_eav-ui_src_-5efbee.4b6ad72ab65541bc.js.map