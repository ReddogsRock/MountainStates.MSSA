"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_app-administration_web-api-rest-api_web-api-rest-api_component_ts"],{79262:(L,E,s)=>{s.r(E),s.d(E,{WebApiRestApiComponent:()=>d});var u=s(44444),P=s(64173),_=s(34456),D=s(84175),M=s(53777),C=s(93840),I=s(64043),T=s(29658),g=s(12938),v=s(79996),O=s(80132),f=s(34435),R=s(67037),W=s(60852),t=s(99293),U=s(87698),e=s(23731);function a(r,c){if(1&r&&(t.j41(0,"mat-option",4),t.EFF(1),t.k0s()),2&r){const o=c.$implicit;t.Y8G("value",o.path),t.R7$(),t.SpI(" ",o.name," ")}}function p(r,c){if(1&r&&t.Z7z(0,a,2,2,"mat-option",4,t.fX1),2&r){const o=t.XpG();t.Dyx(o.webApisTypes().sort())}}function n(r,c){1&r&&t.nrm(0,"app-rest-api-help-text",3),2&r&&t.Y8G("apiTitle","Web Api")}const i={all:!1,webApisTypes:!0,syncUrl:!0};let d=(()=>{class r{#e;#t;#s;constructor(){this.log=(0,f.Tq)({WebApiRestApiComponent:r},i),this.#e=(0,g.d)(v.F),this.#t=(0,g.d)(W.c),this.#s=(0,u.WQX)(_.ok),this.#a=(0,u.vPA)(0),this.#p=this.#e.getWebApisLive(this.#a),this.webApisTypes=(0,P.EW)(()=>this.#p()),this.webApiTypeForm=this.#s.group({webApiType:[""]}),(0,P.QZ)(()=>{const o=this.log.fnIf("syncUrl"),l=this.webApisTypes();if(0===l.length)return o.end();const h=this.#t.urlSegments.at(-1);var m=h.replace(/%252F/g,"/");const A=l.find(x=>x.path===m);o.a("status:",{webApis:l,webApi:A,urlPath:h,encodedUrlPath:m}),A&&this.webApiTypeForm.get("webApiType").setValue(A.path),o.end()})}#a;#p;openRestApi(o){o&&this.#t.navRelative([encodeURIComponent(o)])}static#n=this.\u0275fac=function(l){return new(l||r)};static#i=this.\u0275cmp=t.VBU({type:r,selectors:[["app-web-api-rest-api"]],decls:8,vars:3,consts:[[3,"formGroup"],["color","accent",1,"eav-mat-form-field"],["formControlName","webApiType",3,"valueChange"],[3,"apiTitle"],[3,"value"]],template:function(l,h){if(1&l&&(t.j41(0,"form",0)(1,"mat-form-field",1)(2,"mat-label"),t.EFF(3,"Endpoint"),t.k0s(),t.j41(4,"mat-select",2),t.bIt("valueChange",function(A){return h.openRestApi(A)}),t.nVh(5,p,2,0),t.k0s()()(),t.nVh(6,n,1,1,"app-rest-api-help-text",3),t.nrm(7,"router-outlet")),2&l){let m;t.Y8G("formGroup",h.webApiTypeForm),t.R7$(5),t.vxM(h.webApisTypes()?5:-1),t.R7$(),t.vxM(null!=(m=h.webApiTypeForm.get("webApiType"))&&m.value?-1:6)}},dependencies:[I.M,U.j,U.M,I.g,e.M,D.Hl,M.Hu,C.m_,_.X1,_.qT,_.BC,_.cb,_.j4,_.JD,T.n3,R.p,O.q],encapsulation:2})}return r})()},79996:(L,E,s)=>{s.d(E,{F:()=>W});var u=s(46443),P=s(64173),_=s(70271),D=s(96474),M=s(99293),C=s(44444);const T="admin/AppFiles/asset",O="admin/ApiExplorer/AppApiFiles";let W=(()=>{class t extends D.D{get(e,a,p){return this.getHttpApiUrl(T,{params:{appId:this.appId,global:a,...this.templateIdOrPath(e,a,p)}}).pipe((0,_.T)(n=>{if("auto"===n.Type.toLocaleLowerCase())switch(n.Extension.toLocaleLowerCase()){case".cs":case".cshtml":n.Type="Razor";break;case".html":case".css":case".js":n.Type="Token"}return n}))}save(e,a,p,n){return this.http.post(this.apiUrl(T),p,{params:{appId:this.appId,global:a,...this.templateIdOrPath(e,a,n)}})}getAllPromise(e){return this.fetchPromise("admin/AppFiles/AppFiles",{params:{appId:this.appId,...e&&{mask:e}}}).then(({Files:a})=>(a.forEach(p=>{p.Shared??=!1}),a))}getWebApis(){return this.getHttpApiUrl(O,{params:{appId:this.appId}}).pipe((0,_.T)(({files:e})=>(e.forEach(a=>{a.isShared??=!1,a.isCompiled??=!1}),e))).pipe((0,_.T)(e=>e.map(p=>{const n=p.path.lastIndexOf("/"),i=p.path.lastIndexOf("."),d=p.path.substring(0,n),r=p.path.substring(n+1,i);return{path:p.path,folder:d,name:r,isShared:p.isShared,endpointPath:p.endpointPath,isCompiled:p.isCompiled,edition:p.edition}})))}getWebApisLive(e){const a=(0,u.fx)(()=>(e(),{url:this.apiUrl(O),params:{appId:this.appId}}));return(0,P.EW)(()=>{const n=a.value()?.files;return n?(n.forEach(i=>{i.isShared??=!1,i.isCompiled??=!1}),n.map(i=>{const d=i.path.lastIndexOf("/"),r=i.path.lastIndexOf("."),c=i.path.substring(0,d),o=i.path.substring(d+1,r);return{path:i.path,folder:c,name:o,isShared:i.isShared,endpointPath:i.endpointPath,isCompiled:i.isCompiled,edition:i.edition}})):[]})}getWebApiDetails(e){return this.getHttpApiUrl("admin/ApiExplorer/inspect",{params:{appId:this.appId,zoneId:this.zoneId,path:e}})}getPredefinedTemplates(e,a){return this.fetchPromise("admin/AppFiles/GetTemplates",{params:{...e&&{purpose:e},...a&&{type:a}}})}getPreview(e,a,p){return this.getHttpApiUrl("admin/AppFiles/preview",{params:{appId:this.appId,path:e,templateKey:p,global:a}})}create(e,a,p){return this.http.post(this.apiUrl("admin/AppFiles/create"),{},{params:{appId:this.appId,global:a,purpose:"auto",path:e,templateKey:p}})}templateIdOrPath(e,a,p){if(/^[0-9]*$/g.test(e)){const n=p.find(i=>i.EntityId?.toString()===e&&i.IsShared===a)?.Path;return{templateId:e,...null!=n&&{path:n}}}return{path:e}}static#e=this.\u0275fac=(()=>{let e;return function(p){return(e||(e=M.xGo(t)))(p||t)}})();static#t=this.\u0275prov=C.jDH({token:t,factory:t.\u0275fac})}return t})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/20.00.09/dist/ng-edit/projects_eav-ui_src_app_app-administration_web-api-rest-api_web-api-rest-api_component_ts.4cb332f93e6d3085.js.map