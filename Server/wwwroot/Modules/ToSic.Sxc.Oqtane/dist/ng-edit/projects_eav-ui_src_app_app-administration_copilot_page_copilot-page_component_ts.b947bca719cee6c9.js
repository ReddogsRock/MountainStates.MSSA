"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_app-administration_copilot_page_copilot-page_component_ts"],{1902:(Q,f,a)=>{a.r(f),a.d(f,{CopilotPageComponent:()=>Z});var R,C=a(29658),g=a(87945),v=a(47215),F=a(37580),l=a(44444),t=a(99293),E=a(84175),p=a(53777),D=a(81863),G=a(93840),u=a(64043),$=a(3347),m=a(70271),T=a(64334),x=a(59452),c=a(12938),_=a(91922),y=a(70334),I=a(60852),j=a(68873),k=a(9234),M=a(6663),V=a(86301),X=a(34435);let b=(()=>{class o{static#t=this.webApiEditions="admin/code/getEditions";static#e=this.webApiGeneratedCode="admin/code/generateDataModels";constructor(e,n){this.http=e,this.context=n,this.log=(0,X.Tq)({CopilotService:o}),this.specs=this.#n()}getEditions(){return this.specs.pipe((0,m.T)(e=>e.editions))}getDefaultEdition(){return this.specs.pipe((0,m.T)(e=>e.editions.find(n=>n.isDefault)))}getGenerators(){return this.specs.pipe((0,m.T)(e=>e.generators))}#n(){return this.http.get(R.webApiEditions,{params:{appId:this.context.appId.toString()}}).pipe((0,m.T)(e=>{const n=this.#i(e.editions),i=e.editions.map(s=>{const d=s==n;return{...s,isDefault:d,description:(s.description||"no description provided")+(d?" \u2705":""),label:`/${s.name}/AppCode/Data`.replace(/\/\//g,"/")}});return{...e,editions:i}}),(0,V.t)(1))}#i(e){return e.find(n=>n.isDefault)??e.find(n=>""===n.name)??e[0]}static#o=this.\u0275fac=function(n){return new(n||o)(l.KVO(v.Qq),l.KVO(j.o))};static#a=this.\u0275prov=l.jDH({token:o,factory:o.\u0275fac})}return o})();R=b;var h=a(87698),B=a(23731),S=a(8923);const A=(o,r)=>r.Id;function O(o,r){if(1&o&&(t.j41(0,"mat-option",9)(1,"strong"),t.EFF(2),t.k0s(),t.nrm(3,"br"),t.EFF(4),t.k0s()),2&o){const e=r.$implicit;t.Y8G("value",e.name),t.R7$(2),t.Lme("",e.name," v",e.version),t.R7$(2),t.SpI(" ",e.description," ")}}function H(o,r){1&o&&t.nrm(0,"mat-hint",10),2&o&&t.Y8G("innerHTML",r.descriptionHtml,t.npT)}function Y(o,r){if(1&o){const e=t.RV6();t.j41(0,"mat-form-field",3)(1,"mat-label"),t.EFF(2,"Generator"),t.k0s(),t.j41(3,"mat-select",8),t.mxI("valueChange",function(i){l.eBV(e);const s=t.XpG();return t.DH7(s.selectedGenerator,i)||(s.selectedGenerator=i),l.Njj(i)}),t.j41(4,"mat-select-trigger"),t.EFF(5),t.k0s(),t.Z7z(6,O,5,4,"mat-option",9,t.fX1),t.k0s(),t.nVh(8,H,1,1,"mat-hint",10),t.nI1(9,"async"),t.k0s(),t.nrm(10,"br")}if(2&o){let e;const n=t.XpG();t.R7$(3),t.R50("value",n.selectedGenerator),t.R7$(2),t.SpI(" ",n.selectedGenerator," "),t.R7$(),t.Dyx(r.sort()),t.R7$(2),t.vxM((e=t.bMT(9,3,n.selectedGenerator$))?8:-1,e)}}function N(o,r){if(1&o&&(t.j41(0,"mat-option",9)(1,"strong"),t.EFF(2),t.k0s(),t.EFF(3),t.k0s()),2&o){const e=r.$implicit;t.Y8G("value",e.name),t.R7$(2),t.JRh(e.label),t.R7$(),t.SpI(" (",e.description,") ")}}function P(o,r){if(1&o){const e=t.RV6();t.j41(0,"mat-form-field",3)(1,"mat-label"),t.EFF(2,"Select an Edition to generate code for"),t.k0s(),t.j41(3,"mat-select",8),t.mxI("valueChange",function(i){l.eBV(e);const s=t.XpG();return t.DH7(s.selectedEdition,i)||(s.selectedEdition=i),l.Njj(i)}),t.Z7z(4,N,4,3,"mat-option",9,t.fX1),t.k0s(),t.j41(6,"mat-hint"),t.EFF(7," Editions are managed in the "),t.j41(8,"code"),t.EFF(9,"/App_Data/app.json"),t.k0s(),t.EFF(10," file. See "),t.j41(11,"a",11),t.EFF(12,"docs"),t.k0s(),t.EFF(13,". "),t.k0s()()}if(2&o){const e=t.XpG();t.R7$(3),t.R50("value",e.selectedEdition),t.R7$(),t.Dyx(r.sort())}}function J(o,r){if(1&o&&(t.j41(0,"mat-option",9),t.EFF(1),t.k0s()),2&o){const e=r.$implicit;t.Y8G("value",e),t.R7$(),t.SpI(" ",e.Title," ")}}function z(o,r){1&o&&t.Z7z(0,J,2,2,"mat-option",9,A),2&o&&t.Dyx(r)}function U(o,r){if(1&o){const e=t.RV6();t.j41(0,"button",16),t.bIt("click",function(){l.eBV(e);const i=t.XpG(2);return l.Njj(i.deleteConfiguration())}),t.j41(1,"mat-icon"),t.EFF(2,"delete"),t.k0s()()}}function w(o,r){if(1&o){const e=t.RV6();t.nrm(0,"br"),t.j41(1,"div",12)(2,"mat-form-field",3)(3,"mat-label"),t.EFF(4,"Select a Configuration"),t.k0s(),t.j41(5,"mat-select",13),t.mxI("valueChange",function(i){l.eBV(e);const s=t.XpG();return t.DH7(s.selectedEntity,i)||(s.selectedEntity=i),l.Njj(i)}),t.j41(6,"mat-option",9),t.EFF(7," Empty (press + to create new) "),t.k0s(),t.nVh(8,z,2,0),t.nI1(9,"async"),t.k0s(),t.j41(10,"mat-hint"),t.EFF(11," Reusable configuration for the Data Copilot generator. "),t.k0s()(),t.j41(12,"button",14),t.bIt("click",function(){l.eBV(e);const i=t.XpG();return l.Njj(i.editConfig())}),t.j41(13,"mat-icon"),t.EFF(14),t.k0s()(),t.nVh(15,U,3,0,"button",15),t.k0s()}if(2&o){let e;const n=t.XpG();t.R7$(5),t.R50("value",n.selectedEntity),t.R7$(),t.Y8G("value",void 0),t.R7$(2),t.vxM((e=t.bMT(9,5,n.entities$))?8:-1,e),t.R7$(6),t.JRh(n.selectedEntity?"edit":"add"),t.R7$(),t.vxM(n.selectedEntity?15:-1)}}let L=(()=>{class o{constructor(){this.outputType=(0,F.hFB)(),this.title=(0,F.hFB)("Copilot Generator"),this.#t=(0,c.d)(b),this.#e=(0,c.d)(k.Tr),this.#n=(0,c.d)(I.c),this.#i=(0,c.d)(D.h),this.#o=(0,c.d)($.UG),this.#a=(0,c.d)(j.o),this.#r=(0,c.d)(v.Qq),this.#l=(0,l.WQX)(t.c1b),this.#s="b08dcd23-2eb0-4a5e-a3d0-3178d2aae451",this.webApiGeneratedCode="admin/code/generateDataModels",this.editions$=this.#t.getEditions(),this.showConfigurationDropdown=(0,l.vPA)(!1),this.generators$=this.#t.getGenerators().pipe((0,m.T)(e=>e.filter(n=>n.outputType===this.outputType()))),this.selectedGenerator$=this.generators$.pipe((0,m.T)(e=>e.find(n=>n.name===this.selectedGenerator))),this.selectedGenerator="",this.selectedEdition=""}#t;#e;#n;#i;#o;#a;#r;#l;#s;ngOnInit(){this.generators$.pipe((0,T.s)(1)).subscribe(e=>{this.selectedGenerator=e[0]?.name??""}),this.#t.specs.pipe((0,T.s)(1)).subscribe(e=>{this.selectedEdition=e.editions.find(n=>n.isDefault)?.name??""}),this.fetchEntities(),this.#n.doOnDialogClosed(()=>this.fetchEntities())}fetchEntities(){this.entities$=this.#e.getEntities$((0,x.of)({contentTypeName:this.#s}))}editConfig(){const e={items:[this.selectedEntity?y.c.editId(this.selectedEntity.Id):y.c.newFromType(this.#s)]},n=(0,_.s)(e);this.#n.navRelative([`edit/${n}`])}deleteConfiguration(){const e=this.selectedEntity;this.#i.open(M.F,{autoFocus:!1,data:{entityId:e.Id,entityTitle:e.Title,message:"Are you sure you want to delete?  ",hasDeleteSnackbar:!0},viewContainerRef:this.#l,width:"400px"}).afterClosed().subscribe(s=>{s&&this.#e.delete(this.#a.appId,this.#s,e.Id,!1).subscribe({next:()=>{this.#o.open("Deleted",null,{duration:2e3}),this.fetchEntities()},error:d=>{console.error("Error deleting configuration:",d),this.#o.open("Error deleting configuration",null,{duration:3e3})}})})}toggleConfigurationDropdown(){this.showConfigurationDropdown.set(!this.showConfigurationDropdown())}autoGeneratedCode(){this.#r.get(this.webApiGeneratedCode,{params:{appId:this.#a.appId,edition:this.selectedEdition,generator:this.selectedGenerator,...this.selectedEntity?{configurationId:this.selectedEntity.Id}:{}}}).subscribe(e=>{this.#o.open(e.message+`\n (this took ${e.timeTaken}ms)`,null,{duration:5e3})})}static#c=this.\u0275fac=function(n){return new(n||o)};static#d=this.\u0275cmp=t.VBU({type:o,selectors:[["app-copilot-generator"]],inputs:{outputType:[1,"outputType"],title:[1,"title"]},decls:28,vars:10,consts:[[1,"eav-cards-box"],[1,"eav-card"],[1,"eav-card-header"],["color","accent",1,"eav-mat-form-field"],[1,"eav-card-space-div"],["align","end"],["mat-button","",1,"eav-button__with-icon",3,"click"],[1,"eav-icon"],["required","",3,"valueChange","value"],[3,"value"],[3,"innerHTML"],["href","https://go.2sxc.org/app-json","target","_blank"],[1,"configuration-select"],[3,"valueChange","value"],["mat-icon-button","","aria-label","Create",1,"eav-icon",3,"click"],["mat-icon-button","","aria-label","Delete",1,"eav-icon"],["mat-icon-button","","aria-label","Delete",1,"eav-icon",3,"click"]],template:function(n,i){if(1&n&&(t.j41(0,"div",0)(1,"mat-card",1)(2,"mat-card-header",2)(3,"mat-card-title"),t.EFF(4),t.k0s(),t.j41(5,"mat-icon"),t.EFF(6,"support_agent"),t.k0s()(),t.j41(7,"mat-card-content"),t.nrm(8,"br"),t.nVh(9,Y,11,5),t.nI1(10,"async"),t.nrm(11,"br"),t.nVh(12,P,14,1,"mat-form-field",3),t.nI1(13,"async"),t.nrm(14,"br"),t.nVh(15,w,16,7),t.k0s(),t.nrm(16,"div",4),t.j41(17,"mat-card-actions",5)(18,"button",6),t.bIt("click",function(){return i.toggleConfigurationDropdown()}),t.j41(19,"mat-icon",7),t.EFF(20,"discover_tune"),t.k0s(),t.j41(21,"span"),t.EFF(22,"Use Configuration"),t.k0s()(),t.j41(23,"button",6),t.bIt("click",function(){return i.autoGeneratedCode()}),t.j41(24,"mat-icon",7),t.EFF(25,"code"),t.k0s(),t.j41(26,"span"),t.EFF(27,"Generate Code"),t.k0s()()()()()),2&n){let s,d;t.AVh("eav-cards-box-expanded",i.showConfigurationDropdown()),t.R7$(4),t.JRh(i.title()),t.R7$(5),t.vxM((s=t.bMT(10,6,i.generators$))?9:-1,s),t.R7$(3),t.vxM((d=t.bMT(13,8,i.editions$))?12:-1,d),t.R7$(3),t.vxM(i.showConfigurationDropdown()?15:-1)}},dependencies:[u.M,h.j,h.M,h.c,u.g,u.h,B.M,E.Hl,E.$z,S.M,p.Hu,p.RN,p.YY,p.m2,p.MM,p.dh,G.m_,G.An,g.MD,g.Jj],styles:["mat-card-actions[_ngcontent-%COMP%]{display:flex;width:100%;justify-content:space-between}.eav-cards-box-expanded[_ngcontent-%COMP%]{min-height:200px;transition:min-height .2s}.configuration-select[_ngcontent-%COMP%]{display:flex;gap:8px;align-items:center}"]})}return o})(),Z=(()=>{class o{constructor(e){this.data=e.snapshot.data}static#t=this.\u0275fac=function(n){return new(n||o)(t.rXU(C.nX))};static#e=this.\u0275cmp=t.VBU({type:o,selectors:[["app-data-copilot"]],decls:7,vars:4,consts:[[1,"outer-container"],[3,"outputType","title"]],template:function(n,i){1&n&&(t.j41(0,"div",0)(1,"h1"),t.EFF(2),t.k0s(),t.j41(3,"p"),t.EFF(4),t.k0s()(),t.nrm(5,"app-copilot-generator",1)(6,"router-outlet")),2&n&&(t.R7$(2),t.JRh(i.data.heading),t.R7$(2),t.SpI(" ",i.data.intro," "),t.R7$(),t.Y8G("outputType",i.data.outputType)("title",i.data.title))},dependencies:[L,C.n3],styles:[".outer-container[_ngcontent-%COMP%]{padding:10px 20px}"]})}return o})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/20.00.09/dist/ng-edit/projects_eav-ui_src_app_app-administration_copilot_page_copilot-page_component_ts.b947bca719cee6c9.js.map