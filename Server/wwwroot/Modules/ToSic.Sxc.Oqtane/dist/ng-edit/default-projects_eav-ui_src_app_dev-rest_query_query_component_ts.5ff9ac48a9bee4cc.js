"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["default-projects_eav-ui_src_app_dev-rest_query_query_component_ts"],{3791:(mt,j,n)=>{n.r(j),n.d(j,{DevRestQueryComponent:()=>lt});var S=n(87945),N=n(84175),G=n(31016),C=n(93840),T=n(59791),F=n(41134),x=n(38223),b=n(29658),I=n(75797),f=n(19999),g=n(70271),R=n(71870),l=n(14079),E=n(12938),w=n(75445),M=n(4096),U=n(50052),A=n(34601),V=n(68873),X=n(91091),P=n(55630),B=n(1708),Y=n(22422),k=n(53966),L=n(16768),H=n(61426),z=n(37580),t=n(99293);let J=(()=>{class a{constructor(){this.data=(0,z.hFB)(),this.scenarios=l.vm}ngOnInit(){}static#t=this.\u0275fac=function(s){return new(s||a)};static#e=this.\u0275cmp=t.VBU({type:a,selectors:[["app-dev-query-introduction"]],inputs:{data:[1,"data"]},decls:12,vars:0,consts:[["href","https://docs.2sxc.org/index.html","target","_blank"],["href","https://docs.2sxc.org/basics/query/index.html","target","_blank"],["href","https://docs.2sxc.org/web-api/query-rest-web-api.html","target","_blank"]],template:function(s,i){1&s&&(t.j41(0,"p"),t.EFF(1," To learn more about queries you may want to read these "),t.j41(2,"a",0),t.EFF(3,"docs"),t.k0s(),t.EFF(4,":\n"),t.k0s(),t.j41(5,"ul")(6,"li")(7,"a",1),t.EFF(8,"Queries in 2sxc"),t.k0s()(),t.j41(9,"li")(10,"a",2),t.EFF(11,"Query REST API"),t.k0s()()())},encapsulation:2})}return a})();function O(a,r,e,s,i,d,o){const c="/"!==s[0]&&!s.startsWith("http");o&&o.length&&"?"!==o[0]&&(o="?"+o);const h=c?`${o}${o?"&":"?"}PageId=${e.tabId}&ModuleId=${e.moduleId}`:"",v=a.http.apiUrl(s)+h,u=s+o,m=`${s}/${d??"Default"}${o}`;return[new l.b2(c,"GET",u,"read all query streams","Read list of all items",!0,D(r,u,e),v),new l.b2(c,"GET",m,"read only Stream Default","Read list of all items",!0,D(r,m,e),v)]}function D(a,r,e,s){const i=e.moduleId,d="/"!==r[0],o=[],c=`${r}?PageId=${e.tabId}&ModuleId=${i}`;a.inSameContext&&o.push(new l.EI("Example with global $2sxc and event-context","This example finds the context information from the HTML where an action started.",`\n<button onclick="$2sxc(this).webApi.get('${r}').then(data => console.log(data))">\n  get it\n</button>`,!1,[l.Ms])),a.in2sxc&&o.push(new l.EI(`Example with global $2sxc and a Module-Id ${i}`,"This is how you get the context when your code doesn't start with a DOM context, so you need the moduleId.",`\n// get the sxc-controller for this module\nvar sxc = $2sxc(${i});\n// now get the data in the promise\nsxc.webApi.get('${r}')\n  .then(data => {\n    console.log(data)\n  });`,!1,[l.Ms]),new l.EI("Same example as one-liner","This is the same as above, but as a one-liner so you can run it directly in the F12 console right now.",`$2sxc(${i}).webApi.get('${r}').then(data => console.log('just got:', data));`,!0)),a.in2sxc&&a.inSameContext&&o.push(new l.EI("Example where you get the Module-Id from Razor","This example doesn't use a fixed moduleId but let's the Razor add the current moduleId when the page is rendered.",`\n// this will be replaced on the server with the ID\nvar moduleId = @Dnn.Module.ModuleID;\nvar sxc = $2sxc(moduleId);\nvar promise = sxc.webApi.get('${r}');`,!1,[l.Ms]));const h=d?`$2sxc.http.apiUrl('${r}')`:`'${r}'`,v=d?`$2sxc.http.apiUrl('${c}')`:`'${c}'`;return a.inSameSite?(o.push(new l.EI("Using jQuery inside DNN","This example uses jQuery instead of the $2sxc to do the AJAX call.\n      It shows you how to resolve the virtual path for use in other ways.",`\nvar endpoint = ${h};\n$.ajax({\n  url:endpoint,\n  beforeSend: $.dnnSF(${i}).setModuleHeaders\n}).then(data => {\n  console.log('Got this data:', data);\n})`,!1,[])),o.push(new l.EI("Using jQuery as single-liner","The same example as above, just as single-liner so you can test it directly in the F12 console.\n      This will only work if you're on a DNN page with this module.",`$.ajax({url: ${h}, beforeSend: $.dnnSF(${i}).setModuleHeaders }).then(data => console.log(data))`,!1,[])),o.push(new l.EI("Using jQuery and add Context in URL","This example uses jQuery instead of the $2sxc to do the AJAX call.\n      But instead of using the DNN Services Framework it adds relevant headers to the url.",`\n$.ajax(${v}).then(data => {\n  console.log('Got this data:', data);\n})`,!1,[])),o.push(new l.EI("Using jQuery with url-context as single-liner","The same example as above, just as single-liner so you can test it directly in the F12 console.\n      This will work on a DNN page which has jQuery activated. ",`$.ajax(${v}).then(data => console.log(data))`,!1,[]))):(o.push(new l.EI("Using jQuery in another Site or External","This example uses jQuery and doesn't use $2sxc or the DNN ServicesFramework,\n      because they would be either missing, or give wrong context-headers.",`\n$.ajax('${r}').then(data => {\n  console.log('Got this data:', data);\n})`,!1,[l.Qd])),o.push(new l.EI("Using jQuery with Context in URL","This example uses jQuery and includes a module-context. This is unusual for external access, but may be needed sometime.",`\n$.ajax('${c}').then(data => {\n  console.log('Got this data:', data);\n})`,!1,[l.Qd]))),o}var p=n(44444),W=n(81863),Z=n(81955),K=n(8923),Q=n(87698);function _(a,r){if(1&a){const e=t.RV6();t.j41(0,"button",16),t.bIt("click",function(){p.eBV(e);const i=t.XpG(2);return p.Njj(i.closeDialog())}),t.j41(1,"mat-icon"),t.EFF(2,"close"),t.k0s()()}}function q(a,r){1&a&&(t.j41(0,"div",17)(1,"mat-icon"),t.EFF(2,"emoji_objects"),t.k0s(),t.j41(3,"span"),t.EFF(4,"Introduction"),t.k0s()())}function tt(a,r){if(1&a&&(t.j41(0,"div",18)(1,"mat-icon"),t.EFF(2,"code_curly"),t.k0s(),t.j41(3,"span"),t.EFF(4),t.k0s()()),2&a){const e=t.XpG();t.Y8G("tippy",(e.scenario.useVirtual?"Virtual ":"Absolute ")+"REST URLs"),t.R7$(4),t.SpI("Call ",e.scenario.useVirtual?"Virtual":"Absolute"," REST URLs")}}function et(a,r){1&a&&(t.j41(0,"mat-icon"),t.EFF(1,"warning"),t.k0s())}function at(a,r){if(1&a&&(t.j41(0,"div",19)(1,"mat-icon"),t.EFF(2,"person"),t.k0s(),t.j41(3,"span"),t.EFF(4),t.k0s(),t.nVh(5,et,2,0,"mat-icon"),t.k0s()),2&a){const e=t.XpG();t.R7$(4),t.SpI("Permissions (",e.permissions.length,")"),t.R7$(),t.vxM(e.permissions.length?-1:5)}}function nt(a,r){1&a&&(t.j41(0,"div",20)(1,"mat-icon"),t.EFF(2,"perm_device_information"),t.k0s(),t.j41(3,"span"),t.EFF(4,"HTTP headers & \xa0"),t.j41(5,"code"),t.EFF(6,"/auto/"),t.k0s()()())}function st(a,r){if(1&a){const e=t.RV6();t.j41(0,"div",0)(1,"div",1)(2,"div",2),t.EFF(3,"Using REST with Query:\xa0 "),t.j41(4,"code"),t.EFF(5),t.k0s()(),t.nVh(6,_,3,0,"button",3),t.k0s(),t.j41(7,"div",4),t.nrm(8,"router-outlet"),t.j41(9,"app-selector-with-help",5),t.bIt("valueChange",function(i){p.eBV(e);const d=t.XpG();return p.Njj(d.changeScenario(i))}),t.k0s(),t.j41(10,"mat-tab-group",6)(11,"mat-tab"),t.DNE(12,q,5,0,"div",7),t.nrm(13,"app-dev-query-introduction",8)(14,"app-dev-rest-tab-introduction",8),t.k0s(),t.j41(15,"mat-tab"),t.DNE(16,tt,5,2,"div",9),t.nrm(17,"app-dev-rest-tab-examples-intro",8),t.j41(18,"div",10)(19,"mat-form-field",11)(20,"mat-label"),t.EFF(21,"Stream Name(s) to Limit, comma-separated"),t.k0s(),t.j41(22,"input",12),t.bIt("input",function(i){p.eBV(e);const d=t.XpG();return p.Njj(d.updateStreams(i))}),t.k0s()(),t.j41(23,"mat-form-field",11)(24,"mat-label"),t.EFF(25,"Additional Url Parameters"),t.k0s(),t.j41(26,"input",13),t.bIt("input",function(i){p.eBV(e);const d=t.XpG();return p.Njj(d.updateParams(i))}),t.k0s()()(),t.nrm(27,"app-dev-rest-urls-and-code",8),t.k0s(),t.j41(28,"mat-tab"),t.DNE(29,at,6,2,"div",14),t.nrm(30,"app-dev-rest-tab-permissions",8),t.k0s(),t.j41(31,"mat-tab"),t.DNE(32,nt,7,0,"div",15),t.nrm(33,"app-dev-rest-tab-headers",8),t.k0s()()()()}if(2&a){const e=r,s=t.XpG();t.R7$(5),t.JRh(e.name),t.R7$(),t.vxM(s.isSideNavContent?-1:6),t.R7$(3),t.Y8G("items",s.scenarios)("valueInput",e.scenario.key),t.R7$(4),t.Y8G("data",e),t.R7$(),t.Y8G("data",e),t.R7$(3),t.Y8G("data",e),t.R7$(5),t.Y8G("value",s.streamNames$.value),t.R7$(4),t.Y8G("value",s.urlParams$.value),t.R7$(),t.Y8G("data",e),t.R7$(3),t.Y8G("data",e),t.R7$(3),t.Y8G("data",e)}}function ot(a,r){1&a&&t.nrm(0,"mat-spinner")}let lt=(()=>{class a extends X.n{#t;constructor(e,s,i,d,o){const c=(0,E.d)(M.Kn);super(e,s,o,i,d,c),this.hostClass="dialog-component",this.urlParams$=new I.t(""),this.streamNames$=new I.t("Default"),this.#t=(0,E.d)(w.xR),this.isSideNavContent=this.router.url.includes(l.N5.routeQuery);const h=(0,f.z)([d.paramMap.pipe((0,g.T)(u=>u.get(l.N5.paramQuery))),this.#t.getAll(U.YX.contentTypes.query).pipe((0,R.u)())]).pipe((0,g.T)(([u,m])=>m.find(y=>y.Guid===u)),(0,R.u)());this.permissions$=this.buildPermissionStream(l.N5.paramQuery);const v=(0,f.z)([h,this.scenario$,this.dialogSettings$]).pipe((0,g.T)(([u,m,y])=>{const $="app/{appname}/query/{queryname}".replace("{queryname}",u.Name).replace("{appname}",m.inSameContext?"auto":encodeURI(y.Context.App.Folder));return this.rootBasedOnScenario($,m)}));this.viewModel$=(0,f.z)([(0,f.z)([h,this.scenario$,this.permissions$]),(0,f.z)([v,this.dialogSettings$]),(0,f.z)([this.streamNames$,this.urlParams$])]).pipe((0,g.T)(([[u,m,y],[$,rt],[dt,ut]])=>({...this.buildBaseViewModel(u.Name,u.Guid,rt,y,$,m),query:u,apiCalls:O(o.$2sxc,m,e,$,0,dt,ut)})))}updateStreams(e){this.streamNames$.next(e.target.value)}updateParams(e){this.urlParams$.next(e.target.value)}static#e=this.\u0275fac=function(s){return new(s||a)(t.rXU(V.o),t.rXU(W.k),t.rXU(b.Ix),t.rXU(b.nX),t.rXU(Z.ob))};static#a=this.\u0275cmp=t.VBU({type:a,selectors:[["app-dev-rest-query"]],hostVars:1,hostBindings:function(s,i){2&s&&t.Avn("className",i.hostClass)},features:[t.Vt3],decls:3,vars:3,consts:[[1,"eav-dialog","eav-no-scrollbar"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],["mat-icon-button","","tippy","Close dialog"],[1,"eav-dialog-content"],["label","Choose Scenario",3,"valueChange","items","valueInput"],["dynamicHeight","","color","accent",1,"mat-tab-group-fit-height","mat-tab-group-fancy-scrollbar","default-fonts"],["class","mat-tab-label-box","tippy","Introduction",4,"matTabLabel"],[3,"data"],["class","mat-tab-label-box",3,"tippy",4,"matTabLabel"],[1,"params-form"],["color","accent",1,"eav-mat-form-field"],["matInput","","placeholder","Default",3,"input","value"],["matInput","","placeholder","?id=27",3,"input","value"],["class","mat-tab-label-box","tippy","Permissions",4,"matTabLabel"],["class","mat-tab-label-box","tippy","HTTP headers and auto",4,"matTabLabel"],["mat-icon-button","","tippy","Close dialog",3,"click"],["tippy","Introduction",1,"mat-tab-label-box"],[1,"mat-tab-label-box",3,"tippy"],["tippy","Permissions",1,"mat-tab-label-box"],["tippy","HTTP headers and auto",1,"mat-tab-label-box"]],template:function(s,i){if(1&s&&(t.nVh(0,st,34,12,"div",0),t.nI1(1,"async"),t.vZN(2,ot,1,0,"mat-spinner")),2&s){let d;t.vxM((d=t.bMT(1,1,i.viewModel$))?0:2,d)}},dependencies:[N.Hl,K.M,A.e,C.m_,C.An,b.n3,B.Y,F.D6,F.LG,x.RI,x.ES,x.mq,x.T8,J,L.M,Y.R,G.M,Q.j,Q.M,T.fS,T.fg,P.X,H.Q,k.J,S.Jj],styles:["mat-spinner[_ngcontent-%COMP%]{margin:50px auto;display:block}"]})}return a})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/20.00.09/dist/ng-edit/default-projects_eav-ui_src_app_dev-rest_query_query_component_ts.5ff9ac48a9bee4cc.js.map