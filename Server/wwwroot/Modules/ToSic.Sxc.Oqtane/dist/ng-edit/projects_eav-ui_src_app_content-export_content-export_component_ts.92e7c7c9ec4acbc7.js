"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_content-export_content-export_component_ts"],{17693:(P,E,e)=>{e.d(E,{X:()=>D,g:()=>R});var g=e(46443),_=e(64173),h=e(96474),l=e(99293),v=e(44444);const D="admin/type/",M="admin/type/get",p="admin/type/list",x="admin/type/scopes";let R=(()=>{class f extends h.D{retrieveContentType(t){return this.getHttpApiUrl(M,{params:{appId:this.appId,contentTypeId:t}})}getType(t){return(0,g.fx)(()=>({url:this.apiUrl(M),params:{appId:this.appId,contentTypeId:t}}))}getTypes(t){return(0,g.fx)(()=>({url:this.apiUrl(p),params:{appId:this.appId,scope:t()}}),{defaultValue:[]})}retrieveContentTypesPromise(t){return this.fetchPromise(p,{params:{appId:this.appId,scope:t}})}getScopesPromise(){return this.fetchPromise(x,{params:{appId:this.appId}}).then(t=>{const i=t.old;return Object.keys(i).map(u=>({name:i[u],value:u}))})}getScopesSig(){const t=(0,g.fx)(()=>({url:this.apiUrl(x),params:{appid:this.appId}}));return(0,_.EW)(()=>{const u=(0,t.value)();if(!u||!u.old)return[];const y=u.old;return Object.keys(y).map(T=>({name:y[T],value:T}))})}getScopesV2Promise(){return this.fetchPromise(x,{params:{appId:this.appId}}).then(t=>t.scopes)}save(t){return this.http.post(this.apiUrl("admin/type/save"),t,{params:{appid:this.appId}})}delete(t){return this.http.delete(this.apiUrl("admin/type/delete"),{params:{appid:this.appId,staticName:t.NameId}})}import(t){const i=new FormData;for(const C of t)i.append("File",C);return this.http.post(this.apiUrl("admin/type/import"),i,{params:{appId:this.appId,zoneId:this.zoneId}})}createGhost(t){return this.http.post(this.apiUrl("admin/type/addghost"),null,{params:{appid:this.appId,sourceNameId:t}})}static#t=this.\u0275fac=(()=>{let t;return function(C){return(t||(t=l.xGo(f)))(C||f)}})();static#e=this.\u0275prov=v.jDH({token:f,factory:f.\u0275fac})}return f})()},32760:(P,E,e)=>{function g(l){return"Escape"===l.key}function _(l){return("s"===l.key||"S"===l.key)&&(l.ctrlKey||l.metaKey)}function h(l){return"Enter"===l.key&&(l.ctrlKey||l.metaKey)}e.d(E,{JY:()=>_,KL:()=>g,YU:()=>h})},56360:(P,E,e)=>{e.d(E,{D:()=>M});var g=e(24467),_=e(99293),h=e(44444);let M=(()=>{class p extends g.B{exportContent(r,d){const m=d?"&selectedids="+d.join():"",I=this.apiUrl("admin/entity/Download")+"?appId="+this.appId+"&language="+r.language+"&defaultLanguage="+r.defaultLanguage+"&contentType="+r.contentTypeStaticName+"&recordExport="+r.recordExport+"&resourcesReferences="+r.resourcesReferences+"&languageReferences="+r.languageReferences+m;window.open(I,"_blank","")}exportJson(r){const d=this.apiUrl("admin/type/Json")+"?appId="+this.appId+"&name="+r;window.open(d,"_blank","")}exportEntity(r,d,m){const I=this.apiUrl("admin/entity/Json")+"?appId="+this.appId+"&id="+r+"&prefix="+d+"&withMetadata="+m;window.open(I,"_blank","")}static#t=this.\u0275fac=(()=>{let r;return function(m){return(r||(r=_.xGo(p)))(m||p)}})();static#e=this.\u0275prov=h.jDH({token:p,factory:p.\u0275fac})}return p})()},75727:(P,E,e)=>{e.r(E),e.d(E,{ContentExportComponent:()=>j});var g=e(87945),_=e(34456),h=e(84175),l=e(31403),v=e(81863),D=e(31016),M=e(93840),p=e(53804),x=e(64043),r=e(75797),d=e(61873),m=e(12938),I=e(17693),R=e(64699),f=e(32760),L=e(56360),t=e(99293),i=e(44444),C=e(29658),u=e(87698),y=e(23731),T=e(8923);function F(c,O){if(1&c&&(t.j41(0,"mat-option",11),t.EFF(1),t.k0s()),2&c){const o=O.$implicit;t.Y8G("value",o.NameId),t.R7$(),t.JRh(o.NameId)}}function A(c,O){if(1&c&&(t.j41(0,"mat-radio-button",16),t.EFF(1),t.k0s()),2&c){const o=t.XpG(2);t.R7$(),t.SpI(" Export selected ",o.itemIds.length," items ")}}function U(c,O){if(1&c){const o=t.RV6();t.j41(0,"form",null,0)(2,"div",5)(3,"p"),t.EFF(4," This will generate an XML file which you can edit in Excel. If you just want to import new data, use this to export the schema that you can then fill in using Excel. Please visit "),t.j41(5,"a",6),t.EFF(6,"https://2sxc.org/help"),t.k0s(),t.EFF(7," for more instructions. "),t.k0s(),t.j41(8,"div",7)(9,"div")(10,"mat-form-field",8)(11,"mat-label"),t.EFF(12,"Languages"),t.k0s(),t.j41(13,"mat-select",9),t.mxI("ngModelChange",function(n){i.eBV(o);const s=t.XpG();return t.DH7(s.formValues.language,n)||(s.formValues.language=n),i.Njj(n)}),t.j41(14,"mat-option",10),t.EFF(15,"All"),t.k0s(),t.Z7z(16,F,2,2,"mat-option",11,t.fX1),t.k0s()()(),t.j41(18,"div")(19,"p",12),t.EFF(20,"Export data"),t.k0s(),t.j41(21,"mat-radio-group",13),t.mxI("ngModelChange",function(n){i.eBV(o);const s=t.XpG();return t.DH7(s.formValues.recordExport,n)||(s.formValues.recordExport=n),i.Njj(n)}),t.j41(22,"mat-radio-button",14),t.EFF(23,"No, just export blank data schema (for new data import) "),t.k0s(),t.j41(24,"mat-radio-button",15),t.EFF(25,"Yes, export all content-items"),t.k0s(),t.nVh(26,A,2,1,"mat-radio-button",16),t.k0s()(),t.j41(27,"div")(28,"p",12),t.EFF(29,"Value references to other languages"),t.k0s(),t.j41(30,"mat-radio-group",17),t.mxI("ngModelChange",function(n){i.eBV(o);const s=t.XpG();return t.DH7(s.formValues.languageReferences,n)||(s.formValues.languageReferences=n),i.Njj(n)}),t.j41(31,"mat-radio-button",18),t.EFF(32,"Keep references to other languages (for re-import) "),t.k0s(),t.j41(33,"mat-radio-button",19),t.EFF(34,"Replace references with values"),t.k0s()()(),t.j41(35,"div")(36,"p",12),t.EFF(37,"File / page references"),t.k0s(),t.j41(38,"mat-radio-group",20),t.mxI("ngModelChange",function(n){i.eBV(o);const s=t.XpG();return t.DH7(s.formValues.resourcesReferences,n)||(s.formValues.resourcesReferences=n),i.Njj(n)}),t.j41(39,"mat-radio-button",18),t.EFF(40,"Keep references (for re-import, for example Page:4711) "),t.k0s(),t.j41(41,"mat-radio-button",19),t.EFF(42,"Replace references with real URLs (for example /Portals/0...) "),t.k0s()()()()(),t.j41(43,"mat-dialog-actions",21)(44,"button",22),t.bIt("click",function(){i.eBV(o);const n=t.XpG();return i.Njj(n.exportContent())}),t.EFF(45," Export Data "),t.k0s()()()}if(2&c){const o=t.sdS(1),a=t.XpG();t.R7$(13),t.R50("ngModel",a.formValues.language),t.R7$(3),t.Dyx(a.languages),t.R7$(5),t.R50("ngModel",a.formValues.recordExport),t.R7$(5),t.vxM(a.hasIdList?26:-1),t.R7$(4),t.R50("ngModel",a.formValues.languageReferences),t.Y8G("disabled","Blank"===a.formValues.recordExport),t.R7$(8),t.R50("ngModel",a.formValues.resourcesReferences),t.Y8G("disabled","Blank"===a.formValues.recordExport),t.R7$(6),t.Y8G("disabled",!o.form.valid)}}let j=(()=>{class c{constructor(o,a){this.dialog=o,this.route=a,this.hostClass="dialog-component",this.contentExportService=(0,m.d)(L.D),this.contentTypesService=(0,m.d)(I.g),this.dialogConfigSvc=(0,m.d)(R.L),this.hasIdList=!1,this.loading$=new r.t(!1),this.contentType$=new r.t(null),this.contentTypeStaticName=this.route.snapshot.paramMap.get("contentTypeStaticName");const n=this.route.snapshot.paramMap.get("selectedIds");this.hasIdList=!!n,this.hasIdList&&(this.itemIds=n.split(",").map(s=>parseInt(s,10)))}ngOnInit(){this.#t(),this.loading$.next(!0);const o=this.contentTypesService.retrieveContentType(this.contentTypeStaticName),a=this.dialogConfigSvc.getCurrent$();(0,d.p)([o,a]).subscribe(([n,s])=>{this.contentType$.next(n),this.languages=s.Context.Language.List,this.formValues={defaultLanguage:s.Context.Language.Primary,contentTypeStaticName:this.contentTypeStaticName,language:"",recordExport:this.hasIdList?"Selection":"All",languageReferences:"Link",resourcesReferences:"Link"},this.loading$.next(!1)})}ngOnDestroy(){this.contentType$.complete(),this.loading$.complete()}closeDialog(){this.dialog.close()}exportContent(){this.contentExportService.exportContent(this.formValues,this.hasIdList&&"Selection"===this.formValues.recordExport?this.itemIds:null)}#t(){this.dialog.keydownEvents().subscribe(o=>{(0,f.YU)(o)&&(o.preventDefault(),this.exportContent())})}static#e=this.\u0275fac=function(a){return new(a||c)(t.rXU(v.k),t.rXU(C.nX))};static#n=this.\u0275cmp=t.VBU({type:c,selectors:[["app-content-export"]],hostVars:1,hostBindings:function(a,n){2&a&&t.Avn("className",n.hostClass)},decls:10,vars:6,consts:[["ngForm","ngForm"],[1,"eav-dialog"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],["mat-icon-button","","tippy","Close dialog",3,"click"],[1,"eav-dialog-content"],["href","https://2sxc.org/help","target","_blank"],[1,"dialog-form-content","fancy-scrollbar-light"],["color","accent",1,"eav-mat-form-field"],["name","Language",3,"ngModelChange","ngModel"],["value",""],[3,"value"],[1,"eav-radio-group-label"],["name","RecordExport",1,"eav-radio-group",3,"ngModelChange","ngModel"],["value","Blank"],["value","All"],["value","Selection"],["name","LanguageReferences",1,"eav-radio-group",3,"ngModelChange","ngModel","disabled"],["value","Link"],["value","Resolve"],["name","ResourcesReferences",1,"eav-radio-group",3,"ngModelChange","ngModel","disabled"],["align","end"],["mat-raised-button","",1,"eav-action-button",3,"click","disabled"]],template:function(a,n){if(1&a&&(t.j41(0,"div",1)(1,"div",2)(2,"div",3),t.EFF(3),t.nI1(4,"async"),t.k0s(),t.j41(5,"button",4),t.bIt("click",function(){return n.closeDialog()}),t.j41(6,"mat-icon"),t.EFF(7,"close"),t.k0s()()(),t.nVh(8,U,46,8,"form"),t.nI1(9,"async"),t.k0s()),2&a){let s;t.R7$(3),t.SpI(" Export ",null==(s=t.bMT(4,2,n.contentType$))?null:s.Name," "),t.R7$(5),t.vxM(!1===t.bMT(9,4,n.loading$)?8:-1)}},dependencies:[_.YN,_.qT,_.BC,_.cb,_.vS,_.cV,D.M,u.j,u.M,M.m_,M.An,x.M,x.g,y.M,l.M,p.Wk,p.VT,p._g,v.M,h.Hl,h.$z,T.M,g.Jj],styles:[".eav-radio-group-label[_ngcontent-%COMP%]{font-size:18px;margin:24px 0 0}.eav-radio-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin:8px 0}"]})}return c})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/20.00.09/dist/ng-edit/projects_eav-ui_src_app_content-export_content-export_component_ts.92e7c7c9ec4acbc7.js.map